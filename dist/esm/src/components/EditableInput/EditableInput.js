import{slicedToArray as o,defineProperty as e}from"../../../_virtual/_rollupPluginBabelHelpers.js";import{jsx as t}from"react/jsx-runtime";import n from"classnames";import{forwardRef as r,useState as i,useRef as a,useCallback as s,useLayoutEffect as u,useEffect as l}from"react";import c from"autosize";import d from"../../hooks/useStyle.js";import m from"../../hooks/useMergeRefs.js";import{isTabEvent as f,isEnterEvent as p,isEscapeEvent as v,isArrowUpEvent as E,isArrowDownEvent as T,isArrowLeftEvent as b,isArrowRightEvent as g}from"../../utils/dom-event-utils.js";import{InputType as A}from"./EditableInputConstants.js";import{getTestId as h,ComponentDefaultTestId as y}from"../../tests/test-ids-utils.js";import C from"./EditableInput.module.scss.js";var I=r((function(r,I){var j=r.className,x=r.inputType,_=void 0===x?A.INPUT:x,B=r.autoSize,P=void 0!==B&&B,R=r.id,w=r.tabIndex,D=r.autoComplete,F=void 0===D||D,K=r.disabled,L=void 0!==K&&K,k=r.maxLength,N=r.placeholder,S=void 0===N?"":N,X=r.onClick,z=r.onKeyPress,M=r.shouldFocusOnMount,O=void 0===M||M,H=r.selectOnMount,U=r.value,V=r.customColor,q=r.ignoreBlurClass,W=r.onFinishEditing,G=r.onIgnoreBlurEvent,J=r.onFocus,Q=r.onBlur,Y=r.isValidValue,Z=r.onChange,$=r.onError,oo=r.onSuccess,eo=r.onKeyDown,to=r.onTabHandler,no=r.onCancelEditing,ro=r.textareaSubmitOnEnter,io=void 0!==ro&&ro,ao=r.onArrowKeyDown,so=r.ariaLabel,uo=r["data-testid"],lo=i(U||""),co=o(lo,2),mo=co[0],fo=co[1],po=a(null),vo=m({refs:[I,po]}),Eo=s((function(){po.current&&P&&_===A.TEXT_AREA&&c(po.current)}),[po,P,_]),To=s((function(){po.current&&requestAnimationFrame((function(){var o;null===(o=po.current)||void 0===o||o.focus()}))}),[po]),bo=s((function(o){J&&J(o)}),[J]),go=s((function(o){if(t=q,(e=o.relatedTarget)&&t&&e.classList.contains(t))G(mo);else{var e,t,n=o;n.origin="blur",W&&W(mo,n),Q&&Q(n)}}),[q,mo,W,Q,G]),Ao=s((function(o){var e=o.target.value;!Y||Y(e)?(fo(e),Z&&Z(e),oo&&oo()):$&&$()}),[Y,Z,$,oo]),ho=s((function(){po.current&&po.current.select()}),[po]),yo=s((function(){po.current&&(po.current.value="",po.current.value=mo)}),[po,mo]),Co=s((function(o){return eo?eo(o,mo):to&&f(o)&&_!==A.TEXT_AREA?(o.preventDefault(),to(mo,o)):(W&&p(o)&&(_!==A.TEXT_AREA||io)&&W(mo,o),no&&v(o)&&no(o),void(ao&&(E(o)||T(o)||b(o)||g(o))&&ao(mo,o)))}),[eo,_,mo,to,io,W,no,ao]);u((function(){O&&To(),Eo(),H?ho():yo()}),[]),l((function(){fo(U)}),[U]);var Io=d(void 0,{color:V}),jo=_===A.TEXT_AREA&&P?1:void 0;return t(_,{ref:vo,id:R,"data-testid":uo||h(y.EDITABLE_INPUT,R),style:Io,className:n(C.editableInputWrapper,j,e({},C.noResize,P)),onChange:Ao,onKeyDown:Co,onBlur:go,onFocus:bo,onClick:X,onKeyPress:z,value:mo,placeholder:S,dir:"auto",tabIndex:w,autoComplete:F?"on":"off",rows:jo,maxLength:k,"aria-label":so,disabled:L})}));export{I as default};
