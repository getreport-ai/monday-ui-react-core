import{slicedToArray as t}from"../../../_virtual/_rollupPluginBabelHelpers.js";import{jsx as e}from"react/jsx-runtime";import r from"classnames";import i,{forwardRef as s,useRef as o,useState as n,useCallback as a,useMemo as l}from"react";import c from"../../hooks/useMergeRefs.js";import m from"../../hooks/useKeyEvent/index.js";import{VirtualizedListItems as d}from"./VirtualizedListItems/VirtualizedListItems.js";import{keyCodes as u,UP_DOWN_ARROWS as f}from"../../constants/keyCodes.js";import{withStaticProps as p}from"../../types/withStaticProps.js";import{ListWrapperComponentType as v}from"./ListConstants.js";import{getTestId as b,ComponentDefaultTestId as j}from"../../tests/test-ids-utils.js";import{ListContext as y}from"./utils/ListContext.js";import{useListId as h,getListItemIndexById as L,getListItemIdByIndex as k,getListItemComponentType as x}from"./utils/ListUtils.js";import I from"./List.module.scss.js";var g=s((function(s,p){var v=s.className,A=s.id,O=s.component,R=void 0===O?g.components.UL:O,C=s.children,P=s.ariaLabel,V=s.ariaDescribedBy,_=s.renderOnlyVisibleItems,D=void 0!==_&&_,E=s.style,N=s["data-testid"],U=h(A),W=o(null),z=n(0),B=t(z,2),S=B[0],T=B[1],w=c({refs:[p,W]}),F=R,H=o([]),K=a((function(t){var e;T(L(H,t)),null===(e=null==W?void 0:W.current)||void 0===e||e.setAttribute("aria-activedescendant",t)}),[]),M=a((function(t){if(!D){t.preventDefault();var e=void 0;t.key===u.DOWN_ARROW&&H.current.length>S+1?e=S+1:t.key===u.UP_ARROW&&S>0&&(e=S-1),void 0!==e&&(K(k(H,e)),H.current[e].focus())}}),[S,D,K]);m({keys:f,callback:M,ref:W});var q=l((function(){var t=Array.isArray(C)?C:[C];return D?t=e(d,{children:t}):(H.current=H.current.slice(0,t.length),t=i.Children.map(t,(function(t,e){if(!i.isValidElement(t))return t;var r=t.props.id||"".concat(U,"-item-").concat(e);return i.cloneElement(t,{ref:function(t){return H.current[e]=t},tabIndex:S===e?0:-1,id:r,component:x(R)})}))),t}),[C,R,S,U,D]);return e(y.Provider,Object.assign({value:{updateFocusedItem:K}},{children:e(F,Object.assign({"data-testid":N||b(j.LIST,A),ref:w,style:E,className:r(I.list,v),id:U,"aria-label":P,"aria-describedby":V,tabIndex:-1,role:"listbox"},{children:q}))}))})),A=p(g,{components:v});export{A as default};
