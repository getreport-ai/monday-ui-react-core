import{objectSpread2 as e,slicedToArray as n,defineProperty as o,extends as t,toConsumableArray as r}from"../../../_virtual/_rollupPluginBabelHelpers.js";import{getTestId as a,ComponentDefaultTestId as i}from"../../tests/testIds.js";import s from"classnames";import{SIZES as l}from"../../constants/sizes.js";import u,{forwardRef as p,useRef as c,useMemo as d,useState as m,useCallback as f}from"react";import C,{components as O}from"react-select";import v from"react-select/async";import{noop as M}from"lodash-es";import{WindowedMenuList as g}from"react-windowed-select";import"prop-types";import h from"./components/menu/menu.js";import w from"./components/DropdownIndicator/DropdownIndicator.js";import y from"./components/option/option.js";import b from"./components/singleValue/singleValue.js";import D from"./components/ClearIndicator/ClearIndicator.js";import S from"./components/MultiValueContainer/MultiValueContainer.js";import{ADD_AUTO_HEIGHT_COMPONENTS as I,defaultCustomStyles as j,DROPDOWN_ID as R}from"./DropdownConstants.js";import W,{customTheme as V}from"./Dropdown.styles.js";import N from"./components/Control/Control.js";import{DROPDOWN_CHIP_COLORS as P}from"./dropdown-constants.js";import x from"./components/menu/menu.module.scss.js";import E from"./Dropdown.module.scss.js";var z=p((function(l,p){var j=l.className,R=l.optionWrapperClassName,P=l.singleValueWrapperClassName,z=l.dropdownMenuWrapperClassName,F=l.placeholder,A=l.disabled,L=l.readOnly,T=l.onMenuOpen,B=l.onMenuClose,k=l.onFocus,H=l.onBlur,K=l.onChange,_=l.searchable,q=l.options,U=l.defaultValue,G=l.value,J=l.noOptionsMessage,Q=l.openMenuOnFocus,X=l.openMenuOnClick,Y=l.clearable,Z=l.OptionRenderer,$=l.optionRenderer,ee=l.ValueRenderer,ne=l.valueRenderer,oe=l.menuRenderer,te=l.menuPlacement,re=l.rtl,ae=l.size,ie=l.asyncOptions,se=l.cacheOptions,le=l.defaultOptions,ue=l.isVirtualized,pe=l.menuPortalTarget,ce=l.extraStyles,de=l.maxMenuHeight,me=l.menuIsOpen,fe=l.tabIndex,Ce=l.id,Oe=l.autoFocus,ve=l.multi,Me=void 0!==ve&&ve,ge=l.multiline,he=void 0!==ge&&ge,we=l.onOptionRemove,ye=l.onOptionSelect,be=l.onClear,De=l.onInputChange,Se=l.closeMenuOnSelect,Ie=void 0===Se?!Me:Se,je=l.withMandatoryDefaultOptions,Re=l.isOptionSelected,We=l.insideOverflowContainer,Ve=l.insideOverflowWithTransformContainer,Ne=l.tooltipContent,Pe=l.onKeyDown,xe=l.isLoading,Ee=l.loadingMessage,ze=l.ariaLabel,Fe=l.popupsContainerSelector,Ae=l["data-testid"],Le=c(),Te=pe||Fe&&document.querySelector(Fe),Be=d((function(){return U?Array.isArray(U)?U.map((function(n){return e(e({},n),{},{isMandatory:!0})})):e(e({},U),{},{isMandatory:!0}):U}),[U]),ke=m(Be||[]),He=n(ke,2),Ke=He[0],_e=He[1],qe=m(!1),Ue=n(qe,2),Ge=Ue[0],Je=Ue[1],Qe=$||Z,Xe=ne||ee,Ye=!!G,Ze=null!=G?G:Ke,$e=d((function(){return Array.isArray(Ze)?Ze.reduce((function(n,t){return e(e({},n),{},o({},t.value,t))}),{}):{}}),[Ze]),en=d((function(){return ze||"".concat(L?"Readonly ":""," ").concat(Ne," ").concat(Array.isArray(Ze)?"Selected: ".concat(Ze.map((function(e){return e.label})).join(", ")):"Select")}),[ze,L,Ze,Ne]),nn=Me?Ze:G,on=d((function(){var t=W({size:ae,rtl:re,insideOverflowContainer:We,controlRef:Le,insideOverflowWithTransformContainer:Ve}),r=ce(t),a=Object.entries(r).reduce((function(r,a){var i=n(a,2),s=i[0],l=i[1];return e(e({},r),{},o({},s,(function(e,n){var o=t[s]?t[s](e,n):e;return l(o,n)})))}),{});if(Me){he&&I.forEach((function(n){var o=a[n];a[n]=function(n,t){return e(e({},o(n,t)),{},{height:"auto"})}}));var i=a.valueContainer;a.valueContainer=function(n,o){return e(e({},i(n,o)),{},{paddingLeft:6})}}return a}),[ae,re,We,Ve,ce,Me,he]),tn=f((function(e){return u.createElement(h,t({},e,{Renderer:oe,dropdownMenuWrapperClassName:z}))}),[z,oe]),rn=f((function(e){return u.createElement(w,t({},e,{size:ae}))}),[ae]),an=f((function(e){return u.createElement(y,t({},e,{Renderer:Qe,optionWrapperClassName:R}))}),[Qe,R]),sn=f((function(e){return u.createElement(O.Input,t({},e,{"aria-label":"Dropdown input"}))}),[]),ln=f((function(e){return u.createElement(b,t({},e,{readOnly:L,Renderer:Xe,selectedOption:Ze[0],singleValueWrapperClassName:P}))}),[Xe,L,Ze,P]),un=f((function(e){return u.createElement(D,t({},e,{size:ae}))}),[ae]),pn=d((function(){return function(e,n){we&&we($e[e]);var o=Ke.filter((function(n){return n.value!==e}));K&&K(o,n),_e(o)}}),[K,we,Ke,$e]),cn=d((function(){return{selectedOptions:Ze,onSelectedDelete:pn,setIsDialogShown:Je,isDialogShown:Ge,isMultiline:he,insideOverflowContainer:We,insideOverflowWithTransformContainer:Ve,controlRef:Le,tooltipContent:Ne,popupsContainerSelector:Fe}}),[Ze,pn,Ge,he,We,Ve,Ne,Fe]),dn=ie?v:C,mn=e({},ie&&e({loadOptions:ie,cacheOptions:se},le&&{defaultOptions:le})),fn=e(e({},!ie&&{options:q}),Me&&{isMulti:!0}),Cn=f((function(e){var n,o=e.target;return(null==o||null===(n=o.parentElement)||void 0===n||!n.classList.contains(x.dropdownMenuWrapperFixedPosition))&&(We||Ve)}),[We,Ve]);return u.createElement(dn,t({className:s(E.dropdown,j),selectProps:cn,components:e(e({DropdownIndicator:rn,Menu:tn,ClearIndicator:un,Input:sn,Option:an,Control:N,SingleValue:ln},Me&&{MultiValue:M,ValueContainer:S}),ue&&{MenuList:g}),closeMenuOnScroll:Cn,size:ae,noOptionsMessage:J,placeholder:F,isDisabled:A,isClearable:!L&&Y,isSearchable:!L&&_,readOnly:L,"aria-readonly":L,"aria-label":en,"aria-details":Ne,defaultValue:U,value:nn,onMenuOpen:T,onMenuClose:B,onFocus:k,onBlur:H,onChange:function(e,n){switch(K&&K(e,n),n.action){case"select-option":var o=Me?n.option:e;ye&&ye(o),Ye||_e([].concat(r(Ke),[o]));break;case"clear":be&&be(),Ye||_e(je?Be:[])}},onKeyDown:Pe,onInputChange:De,openMenuOnFocus:Q,openMenuOnClick:X,isRtl:re,styles:on,theme:V,maxMenuHeight:de,menuPortalTarget:Te,menuPlacement:te,menuIsOpen:!L&&me,tabIndex:fe,id:Ce,"data-testid":Ae||a(i.DROPDOWN,Ce),autoFocus:Oe,closeMenuOnSelect:Ie,ref:p,withMandatoryDefaultOptions:je,isOptionSelected:Re,isLoading:xe,loadingMessage:Ee},mn,fn))}));z.size=l,z.chipColors=P,z.defaultProps={className:"",optionWrapperClassName:void 0,dropdownMenuWrapperClassName:void 0,singleValueWrapperClassName:void 0,placeholder:"",onMenuOpen:M,onMenuClose:M,onKeyDown:M,onFocus:M,onBlur:M,onChange:M,onInputChange:M,searchable:!0,options:[],menuPlacement:"bottom",noOptionsMessage:M,clearable:!0,size:l.MEDIUM,extraStyles:j,tabIndex:"0",onOptionRemove:void 0,id:R,autoFocus:!1,closeMenuOnSelect:void 0,ref:void 0,withMandatoryDefaultOptions:!1,insideOverflowContainer:!1,insideOverflowWithTransformContainer:!1,tooltipContent:"",disabled:!1,readOnly:!1,isLoading:!1,loadingMessage:void 0,ariaLabel:void 0};var F=z;export{F as default};
