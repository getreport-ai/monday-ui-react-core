import{defineProperty as e}from"../../../_virtual/_rollupPluginBabelHelpers.js";import{jsx as o,jsxs as i}from"react/jsx-runtime";import a from"classnames";import{forwardRef as n,useRef as t,useCallback as r,useMemo as s,useEffect as l}from"react";import c from"../../hooks/useDebounceEvent/index.js";import d from"../Icon/Icon.js";import{backwardCompatibilityForProperties as m}from"../../helpers/backwardCompatibilityForProperties.js";import u from"../Loader/Loader.js";import p from"../Text/Text.js";import v from"../FieldLabel/FieldLabel.js";import{TextFieldFeedbackState as b,TextFieldTextType as f,FEEDBACK_CLASSES as C,SIZE_MAPPER as h,getActualSize as y,TextFieldAriaLabel as j}from"./TextFieldConstants.js";import{BASE_SIZES as N}from"../../constants/sizes.js";import g from"../../hooks/useMergeRefs.js";import x from"../Clickable/Clickable.js";import{getTestId as T}from"../../tests/testIds.js";import{NOOP as I}from"../../utils/function-utils.js";import{ComponentDefaultTestId as O}from"../../tests/constants.js";import{withStaticProps as F}from"../../types/withStaticProps.js";import L from"./TextField.module.scss.js";var S={primary:"",secondary:"",layout:""},k=n((function(n,b){var N,F,A,E=n.className,D=void 0===E?"":E,z=n.placeholder,_=void 0===z?"":z,w=n.autoComplete,R=void 0===w?"off":w,H=n.value,B=n.onChange,M=void 0===B?I:B,P=n.onBlur,W=void 0===P?I:P,X=n.onFocus,q=void 0===X?I:X,V=n.onKeyDown,K=void 0===V?I:V,U=n.onWheel,Y=void 0===U?I:U,G=n.debounceRate,J=void 0===G?0:G,Q=n.autoFocus,Z=void 0!==Q&&Q,$=n.disabled,ee=void 0!==$&&$,oe=n.readonly,ie=void 0!==oe&&oe,ae=n.setRef,ne=void 0===ae?I:ae,te=n.iconName,re=n.secondaryIconName,se=n.id,le=void 0===se?"input":se,ce=n.title,de=void 0===ce?"":ce,me=n.size,ue=void 0===me?k.sizes.SMALL:me,pe=n.validation,ve=void 0===pe?null:pe,be=n.wrapperClassName,fe=void 0===be?"":be,Ce=n.onIconClick,he=void 0===Ce?I:Ce,ye=n.clearOnIconClick,je=void 0!==ye&&ye,Ne=n.labelIconName,ge=n.showCharCount,xe=void 0!==ge&&ge,Te=n.inputAriaLabel,Ie=n.searchResultsContainerId,Oe=void 0===Ie?"":Ie,Fe=n.activeDescendant,Le=void 0===Fe?"":Fe,Se=n.iconsNames,ke=void 0===Se?S:Se,Ae=n.type,Ee=void 0===Ae?f.TEXT:Ae,De=n.maxLength,ze=void 0===De?null:De,_e=n.trim,we=void 0!==_e&&_e,Re=n.role,He=void 0===Re?"":Re,Be=n.required,Me=void 0!==Be&&Be,Pe=n.loading,We=void 0!==Pe&&Pe,Xe=n.secondaryDataTestId,qe=n.tabIndex,Ve=n.underline,Ke=void 0!==Ve&&Ve,Ue=n.name,Ye=m([n["data-testid"],n.dataTestId],T(O.TEXT_FIELD,le)),Ge=t(null),Je=r((function(e){M(e,{target:Ge.current})}),[M]),Qe=c({delay:J,onChange:Je,initialStateValue:H,trim:we}),Ze=Qe.inputValue,$e=Qe.onEventChanged,eo=Qe.clearValue,oo=s((function(){return re&&Ze?re:te}),[te,re,Ze]),io=r((function(){ee||(je&&(Ge.current&&Ge.current.focus(),Ge.current.value="",eo()),he(oo))}),[Ge,ee,je,he,oo,eo]),ao=s((function(){return ve&&ve.status?C[ve.status]:""}),[ve]),no=te||re,to=xe||ve&&ve.text,ro=re===oo,so=te===oo,lo=re&&ro&&!!Ze,co=g({refs:[b,Ge,ne]});return l((function(){if(Ge.current&&Z){var e=requestAnimationFrame((function(){return Ge.current.focus()}));return function(){return cancelAnimationFrame(e)}}}),[Ge,Z]),o("div",Object.assign({className:a(L.textField,fe,(N={},e(N,L.disabled,ee),e(N,L.onlyUnderline,Ke),N)),role:He,"aria-busy":We},{children:i("div",Object.assign({className:a(L.labelWrapper)},{children:[o(v,{labelText:de,icon:Ne,iconLabel:ke.layout,labelFor:le}),i("div",Object.assign({className:a(L.inputWrapper,h[y(ue)],ao)},{children:[o("input",{className:a(D,L.input,e({},L.inputHasIcon,!!no)),placeholder:_,autoComplete:R,value:Ze,onChange:$e,disabled:ee,readOnly:ie,ref:co,type:Ee,id:le,"data-testid":Ye,name:Ue,onBlur:W,onFocus:q,onKeyDown:K,onWheel:Y,maxLength:ze,role:Oe&&"combobox","aria-label":Te||_,"aria-invalid":ve&&"error"===ve.status,"aria-owns":Oe,"aria-activedescendant":Le,required:Me,tabIndex:qe}),We&&o("div",Object.assign({className:a(L.loaderContainer,e({},L.loaderContainerHasIcon,no))},{children:o("div",Object.assign({className:a(L.loader)},{children:o(u,{svgClassName:a(L.loaderSvg)})}))})),o(x,Object.assign({className:a(L.iconContainer,(F={},e(F,L.iconContainerHasIcon,no),e(F,L.iconContainerActive,so),F)),onClick:io,tabIndex:he!==I&&Ze&&te.length&&so?"0":"-1"},{children:o(d,{icon:te,className:a(L.icon),clickable:!1,iconLabel:ke.primary,iconType:d.type.ICON_FONT,ignoreFocusStyle:!0,iconSize:ue===k.sizes.SMALL?"16px":"18px"})})),o(x,Object.assign({className:a(L.iconContainer,(A={},e(A,L.iconContainerHasIcon,no),e(A,L.iconContainerActive,ro),A)),onClick:io,tabIndex:lo?"0":"-1",dataTestId:Xe||T(O.TEXT_FIELD_SECONDARY_BUTTON,le)},{children:o(d,{icon:re,className:a(L.icon),clickable:!1,iconLabel:ke.secondary,iconType:d.type.ICON_FONT,ignoreFocusStyle:!0,iconSize:ue===k.sizes.SMALL?"16px":"18px"})}))]})),to&&i(p,Object.assign({type:p.types.TEXT2,color:p.colors.SECONDARY,className:a(L.subTextContainer)},{children:[ve&&ve.text&&o("span",Object.assign({className:a(L.subTextContainerStatus)},{children:ve.text})),xe&&o("span",Object.assign({className:a(L.counter),"aria-label":j.CHAR},{children:Ze&&Ze.length||0}))]}))]}))}))})),A=F(k,{sizes:N,feedbacks:b,types:f});export{A as default};
